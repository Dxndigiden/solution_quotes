{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–°–ª—É—á–∞–π–Ω–∞—è —Ü–∏—Ç–∞—Ç–∞</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            padding: 2rem;
        }
        .quote-box {
            background: #ffffff;
            border-radius: 10px;
            padding: 2rem;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            margin-bottom: 1.5rem;
        }
        .buttons button {
            min-width: 70px;
        }
    </style>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
<div class="container" style="max-width: 700px;">
    <h1 class="mb-4 text-center">–°–ª—É—á–∞–π–Ω–∞—è —Ü–∏—Ç–∞—Ç–∞</h1>

    {% if quote %}
        <div class="quote-box">
            <p class="fs-4">"{{ quote.text }}"</p>
            <p class="text-muted">‚Äî {{ quote.source }}</p>
            <p>–ü—Ä–æ—Å–º–æ—Ç—Ä–æ–≤: <span id="views">{{ quote.views }}</span></p>

            <div class="d-flex gap-2 buttons">
                <button id="like-btn" class="btn btn-success">üëç <span id="likes">{{ quote.likes }}</span></button>
                <button id="dislike-btn" class="btn btn-danger">üëé <span id="dislikes">{{ quote.dislikes }}</span></button>
                <a href="{% url 'quotes:add_quote' %}" class="btn btn-primary ms-auto">–î–æ–±–∞–≤–∏—Ç—å —Ü–∏—Ç–∞—Ç—É</a>
            </div>
        </div>

        <script>
            function ajaxVote(url, counterId) {
                $.ajax({
                    url: url,
                    method: "POST",
                    headers: {'X-CSRFToken': '{{ csrf_token }}'},
                    success: function(data) {
                        $('#' + counterId).text(data[counterId]);
                    }
                });
            }

            $('#like-btn').click(function() {
                ajaxVote("{% url 'quotes:like_quote' quote.id %}", "likes");
            });

            $('#dislike-btn').click(function() {
                ajaxVote("{% url 'quotes:dislike_quote' quote.id %}", "dislikes");
            });
        </script>
    {% else %}
        <p class="text-center">–¶–∏—Ç–∞—Ç –ø–æ–∫–∞ –Ω–µ—Ç.</p>
        <div class="text-center mt-3">
            <a href="{% url 'quotes:add_quote' %}" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—É—é —Ü–∏—Ç–∞—Ç—É</a>
        </div>
    {% endif %}

    <p class="mt-3 text-center"><a href="{% url 'quotes:top_quotes' %}" class="btn btn-secondary">–¢–æ–ø-10 —Ü–∏—Ç–∞—Ç</a></p>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
